# abort script on any command that exits with a non zero value
set -e

pushd libjson
  # libjson requires both `make` and `make install`; don't even think
  # of trying to cut corners here.
  make
  # create directory to avoid `cp: cannot stat `_internal/Source/Dependencies/': No such file or directory`
  mkdir -p _internal/Source/Dependencies/
  # create directory to hold libraries. Really.
  mkdir -p $BOSH_INSTALL_TARGET/lib
  # install to libjson.so to /var/vcap/packages/bind-9-9.10.2
  # we don't want to pollute/overwrite the BOSH VM's shared libraries
  make install prefix=$BOSH_INSTALL_TARGET exec_prefix=$BOSH_INSTALL_TARGET SHARED=1
popd

echo $BOSH_INSTALL_TARGET
